<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Mycelium">
<meta name="theme-color" content="#070707">
<meta name="description" content="SolarPunk Mycelium â€” autonomous humanitarian AI. $0/month. Forkable.">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect width='180' height='180' fill='%23070707' rx='40'/><text y='130' x='90' text-anchor='middle' font-size='100'>ğŸŒ¿</text></svg>">
<title>SolarPunk Mycelium</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;700&family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,600;1,9..144,300&display=swap');

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}

:root{
  --green:#00ff88;
  --red:#ff2d6b;
  --gold:#ffd700;
  --blue:#00cfff;
  --bg:#070707;
  --surface:rgba(255,255,255,0.04);
  --border:rgba(255,255,255,0.09);
  --text:rgba(255,255,255,0.85);
  --muted:rgba(255,255,255,0.3);
  --dim:rgba(255,255,255,0.1);
  --safe-top:env(safe-area-inset-top, 0px);
  --safe-bottom:env(safe-area-inset-bottom, 0px);
}

html,body{
  height:100%;background:var(--bg);color:var(--text);
  font-family:'IBM Plex Mono',monospace;
  overflow:hidden;
}

/* App shell */
#app{display:flex;flex-direction:column;height:100vh;height:100dvh}

/* Header */
.app-header{
  padding:calc(var(--safe-top) + 12px) 20px 12px;
  display:flex;align-items:center;gap:12px;
  border-bottom:1px solid var(--border);
  background:rgba(7,7,7,0.95);
  backdrop-filter:blur(20px);
  position:sticky;top:0;z-index:100;
  flex-shrink:0;
}
.header-logo{font-size:1.5rem}
.header-title{
  flex:1;
  font-family:'Fraunces',serif;
  font-size:1.1rem;font-weight:600;
  letter-spacing:-0.02em;
}
.header-status{
  display:flex;align-items:center;gap:6px;
  font-size:.6rem;letter-spacing:1px;text-transform:uppercase;
  color:var(--muted);
}
.pulse{
  width:6px;height:6px;border-radius:50%;
  background:var(--green);box-shadow:0 0 8px var(--green);
  animation:pulse 2s infinite;
}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

/* Content area â€” scrollable */
#content{
  flex:1;overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior-y:contain;
}

/* Bottom nav */
.nav{
  display:flex;
  border-top:1px solid var(--border);
  background:rgba(7,7,7,0.97);
  backdrop-filter:blur(20px);
  padding-bottom:var(--safe-bottom);
  flex-shrink:0;
}
.nav-btn{
  flex:1;display:flex;flex-direction:column;align-items:center;
  gap:4px;padding:12px 8px;
  background:none;border:none;color:var(--muted);
  font-family:'IBM Plex Mono',monospace;
  font-size:.58rem;letter-spacing:.5px;
  cursor:pointer;transition:color .15s;
  text-transform:uppercase;
}
.nav-btn.active{color:var(--green)}
.nav-btn svg{width:20px;height:20px;stroke-width:1.5}
.nav-icon{font-size:1.2rem}

/* Screens â€” each fills content area */
.screen{display:none;padding:20px 16px 40px;min-height:100%}
.screen.active{display:block;animation:fadeIn .2s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}

/* Section headers */
.section-title{
  font-size:.58rem;letter-spacing:3px;text-transform:uppercase;
  color:var(--muted);margin-bottom:14px;
  display:flex;align-items:center;gap:10px;
}
.section-title::after{content:'';flex:1;height:1px;background:var(--border)}

/* Cards */
.card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:16px;padding:18px;margin-bottom:12px;
  position:relative;overflow:hidden;
}
.card::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(0,255,136,.03),transparent 60%);
  pointer-events:none;
}
.card-label{
  font-size:.58rem;letter-spacing:2px;text-transform:uppercase;
  color:var(--muted);margin-bottom:10px;
}
.card h2{
  font-family:'Fraunces',serif;font-weight:300;
  font-size:2.5rem;color:var(--green);line-height:1;
  margin-bottom:4px;
}
.card .sub{font-size:.7rem;color:var(--muted);line-height:1.7}

/* Action buttons */
.btn{
  width:100%;padding:16px;border-radius:14px;
  border:1px solid var(--border);
  background:var(--surface);
  color:var(--text);font-family:'IBM Plex Mono',monospace;
  font-size:.82rem;text-align:left;
  cursor:pointer;transition:all .15s;
  display:flex;align-items:center;gap:14px;
  margin-bottom:10px;
  text-decoration:none;
}
.btn:hover,.btn:active{background:rgba(0,255,136,.06);border-color:rgba(0,255,136,.25)}
.btn-icon{font-size:1.4rem;min-width:28px;text-align:center}
.btn-text{flex:1}
.btn-title{font-size:.88rem;display:block;margin-bottom:3px}
.btn-sub{font-size:.65rem;color:var(--muted);display:block}
.btn-arrow{color:var(--dim)}

.btn.green{border-color:rgba(0,255,136,.2);background:rgba(0,255,136,.05)}
.btn.red{border-color:rgba(255,45,107,.2);background:rgba(255,45,107,.04)}
.btn.gold{border-color:rgba(255,215,0,.2);background:rgba(255,215,0,.04)}

/* Status pill */
.pill{
  display:inline-flex;align-items:center;gap:5px;
  padding:4px 10px;border-radius:20px;
  font-size:.6rem;letter-spacing:1px;text-transform:uppercase;
}
.pill.green{background:rgba(0,255,136,.1);color:var(--green);border:1px solid rgba(0,255,136,.2)}
.pill.gold{background:rgba(255,215,0,.1);color:var(--gold);border:1px solid rgba(255,215,0,.2)}
.pill.red{background:rgba(255,45,107,.1);color:var(--red);border:1px solid rgba(255,45,107,.2)}

/* Share grid */
.share-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.share-card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:14px;padding:16px 14px;
  cursor:pointer;transition:all .15s;
  text-align:center;
}
.share-card:active{transform:scale(.97);background:rgba(0,255,136,.06)}
.share-card .sc-icon{font-size:1.8rem;display:block;margin-bottom:8px}
.share-card .sc-title{font-size:.75rem;font-weight:500;display:block;margin-bottom:3px}
.share-card .sc-sub{font-size:.6rem;color:var(--muted)}

/* Trigger status */
.trigger-status{
  padding:12px 16px;border-radius:10px;
  background:rgba(0,0,0,.4);border:1px solid var(--border);
  font-size:.72rem;color:var(--muted);margin-bottom:12px;
  min-height:48px;
}

/* Input */
.input{
  width:100%;padding:14px 16px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border);
  border-radius:12px;color:var(--text);
  font-family:'IBM Plex Mono',monospace;font-size:.82rem;
  margin-bottom:10px;
  outline:none;
  transition:border-color .15s;
}
.input:focus{border-color:rgba(0,255,136,.3)}
.input::placeholder{color:var(--dim)}
.input-label{
  font-size:.62rem;letter-spacing:2px;text-transform:uppercase;
  color:var(--muted);margin-bottom:8px;display:block;
}

/* Lesson list */
.lesson-item{
  display:flex;align-items:center;gap:14px;
  padding:16px 0;border-bottom:1px solid var(--border);
  cursor:pointer;text-decoration:none;color:var(--text);
  transition:opacity .15s;
}
.lesson-item:active{opacity:.6}
.lesson-emoji{font-size:1.5rem;min-width:32px}
.lesson-meta{flex:1}
.lesson-title{font-size:.88rem;display:block;margin-bottom:3px}
.lesson-tag{font-size:.6rem;color:var(--muted)}
.lesson-arrow{color:var(--dim);font-size:.8rem}

/* Toast */
#toast{
  position:fixed;bottom:calc(80px + var(--safe-bottom));
  left:50%;transform:translateX(-50%) translateY(20px);
  background:rgba(0,255,136,.15);border:1px solid rgba(0,255,136,.3);
  backdrop-filter:blur(20px);
  color:var(--green);padding:12px 24px;border-radius:100px;
  font-size:.78rem;letter-spacing:.5px;
  opacity:0;transition:all .25s;pointer-events:none;
  white-space:nowrap;z-index:999;
}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* Home hero */
.hero-stat{text-align:center;padding:24px 0 16px}
.hero-stat .big{font-family:'Fraunces',serif;font-size:5rem;color:var(--green);line-height:1;font-weight:300}
.hero-stat .label{font-size:.65rem;letter-spacing:3px;text-transform:uppercase;color:var(--muted);margin-top:8px}

/* Repo row */
.repo-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:10px 0;border-bottom:1px solid rgba(255,255,255,.04);
  font-size:.75rem;
}
.repo-row .rname{color:var(--muted)}
.repo-row .rstatus{color:var(--green);font-size:.65rem}

/* Workflow row */
.wf-row{
  display:flex;justify-content:space-between;
  padding:8px 0;border-bottom:1px solid rgba(255,255,255,.04);
  font-size:.72rem;
}
.wf-row .wname{color:var(--muted)}
.wf-row .wsched{color:var(--dim);font-size:.62rem}

/* Install banner */
#install-banner{
  display:none;position:fixed;top:calc(var(--safe-top) + 65px);
  left:10px;right:10px;z-index:200;
  background:rgba(0,255,136,.12);border:1px solid rgba(0,255,136,.3);
  border-radius:14px;padding:14px 16px;
  backdrop-filter:blur(20px);
  display:flex;align-items:center;gap:12px;
}
#install-banner .ib-text{flex:1;font-size:.75rem;line-height:1.5}
#install-banner .ib-title{color:var(--green);font-weight:600;display:block;margin-bottom:2px}
#install-banner .ib-sub{color:var(--muted);font-size:.65rem}
#install-banner button{
  background:var(--green);color:#000;
  border:none;border-radius:8px;
  padding:8px 14px;font-size:.7rem;
  font-family:'IBM Plex Mono',monospace;font-weight:700;
  cursor:pointer;flex-shrink:0;
}
#install-close{background:none!important;color:var(--muted)!important;padding:4px!important}
</style>
</head>
<body>
<div id="app">

  <!-- HEADER -->
  <header class="app-header">
    <span class="header-logo">ğŸŒ¿</span>
    <span class="header-title">SolarPunk Mycelium</span>
    <div class="header-status">
      <div class="pulse"></div>
      <span id="hdr-status">live</span>
    </div>
  </header>

  <!-- CONTENT -->
  <div id="content">

    <!-- HOME -->
    <div class="screen active" id="screen-home">
      <div class="hero-stat">
        <div class="big">$0</div>
        <div class="label">per month Â· always Â· forever</div>
      </div>

      <div class="section-title">Mission</div>
      <div class="card" style="border-color:rgba(255,45,107,.15);background:rgba(255,45,107,.04)">
        <div class="card-label">ğŸŒ¹ Gaza Rose Gallery</div>
        <p style="font-size:.82rem;color:rgba(255,255,255,.5);line-height:1.8;margin-bottom:14px">
          56 original flower artworks Â· $1 each Â· <strong style="color:var(--green)">70%</strong> to Palestine Children's Relief Fund
        </p>
        <a href="https://meekotharaccoon-cell.github.io/gaza-rose-gallery" class="btn red" style="margin:0">
          <span class="btn-icon">ğŸŒ¹</span>
          <span class="btn-text"><span class="btn-title">View Gallery</span><span class="btn-sub">56 flowers Â· Gumroad Â· 4â˜… charity</span></span>
          <span class="btn-arrow">â†’</span>
        </a>
      </div>

      <div class="section-title">System Status</div>
      <div class="card">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px">
          <div style="text-align:center;padding:12px;background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:10px">
            <div style="font-family:'Fraunces',serif;font-size:2rem;color:var(--green)">10</div>
            <div style="font-size:.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px">Workflows</div>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:10px">
            <div style="font-family:'Fraunces',serif;font-size:2rem;color:var(--green)">13</div>
            <div style="font-size:.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px">Lessons</div>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:10px">
            <div style="font-family:'Fraunces',serif;font-size:2rem;color:var(--green)">10</div>
            <div style="font-size:.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px">Repos</div>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:10px">
            <div style="font-family:'Fraunces',serif;font-size:2rem;color:var(--green)" id="stat-stars">â€”</div>
            <div style="font-size:.6rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px">Stars</div>
          </div>
        </div>
        <button class="btn green" onclick="refreshStats()" style="margin:0">
          <span class="btn-icon">ğŸ“¡</span>
          <span class="btn-text"><span class="btn-title">Refresh Live Stats</span><span class="btn-sub">Pulls from GitHub API</span></span>
        </button>
      </div>

      <div class="section-title">Quick Actions</div>
      <a href="https://meekotharaccoon-cell.github.io/solarpunk-learn" class="btn">
        <span class="btn-icon">ğŸ“š</span>
        <span class="btn-text"><span class="btn-title">Free Knowledge Library</span><span class="btn-sub">13 lessons Â· rights Â· money Â· health Â· no paywall</span></span>
        <span class="btn-arrow">â†’</span>
      </a>
      <a href="https://meekotharaccoon-cell.github.io/solarpunk-mutual-aid/board.html" class="btn">
        <span class="btn-icon">ğŸ¤</span>
        <span class="btn-text"><span class="btn-title">Mutual Aid Board</span><span class="btn-sub">Post needs Â· offer help Â· no gatekeeping</span></span>
        <span class="btn-arrow">â†’</span>
      </a>
      <a href="https://github.com/meekotharaccoon-cell/meeko-nerve-center/fork" class="btn gold">
        <span class="btn-icon">ğŸŒ±</span>
        <span class="btn-text"><span class="btn-title">Fork This System</span><span class="btn-sub">$0/month Â· one afternoon Â· your cause</span></span>
        <span class="btn-arrow">â†’</span>
      </a>
    </div>

    <!-- SPREAD -->
    <div class="screen" id="screen-spread">
      <div class="section-title">One Tap Â· Share Everything</div>
      <p style="font-size:.78rem;color:var(--muted);line-height:1.8;margin-bottom:20px">The system spreads itself. Every share is one tap from your phone to someone who needs it â€” via iMessage, WhatsApp, Instagram, AirDrop, whatever you have.</p>

      <div class="share-grid">
        <div class="share-card" onclick="nativeShare('gallery')">
          <span class="sc-icon">ğŸŒ¹</span>
          <span class="sc-title">Gallery</span>
          <span class="sc-sub">Art + Gaza aid</span>
        </div>
        <div class="share-card" onclick="nativeShare('fork')">
          <span class="sc-icon">ğŸŒ±</span>
          <span class="sc-title">Fork</span>
          <span class="sc-sub">Spread the system</span>
        </div>
        <div class="share-card" onclick="nativeShare('learn')">
          <span class="sc-icon">ğŸ“š</span>
          <span class="sc-title">Learn</span>
          <span class="sc-sub">Free knowledge</span>
        </div>
        <div class="share-card" onclick="nativeShare('mutual')">
          <span class="sc-icon">ğŸ¤</span>
          <span class="sc-title">Mutual Aid</span>
          <span class="sc-sub">Help board</span>
        </div>
        <div class="share-card" onclick="nativeShare('app')">
          <span class="sc-icon">ğŸ“±</span>
          <span class="sc-title">This App</span>
          <span class="sc-sub">Install on phone</span>
        </div>
        <div class="share-card" onclick="nativeShare('legal')">
          <span class="sc-icon">âš–ï¸</span>
          <span class="sc-title">Legal Tools</span>
          <span class="sc-sub">Free rights help</span>
        </div>
      </div>

      <div class="section-title">One-Liner (copy it)</div>
      <div class="card" onclick="copyOneLiner()" style="cursor:pointer">
        <div class="card-label">Tap to copy Â· share anywhere</div>
        <p style="font-size:.88rem;line-height:1.9;color:var(--text)" id="one-liner">
          Someone built a $0/month autonomous AI system that funds Palestinian children's aid and anyone can fork it in an afternoon: meekotharaccoon-cell.github.io/meeko-nerve-center/spawn.html
        </p>
        <div style="margin-top:12px;font-size:.62rem;color:var(--green)">ğŸ“‹ Tap to copy</div>
      </div>

      <div class="section-title">Share Templates</div>
      <button class="btn" onclick="shareTemplate('text')">
        <span class="btn-icon">ğŸ’¬</span>
        <span class="btn-text"><span class="btn-title">Text Message</span><span class="btn-sub">Short Â· direct Â· works on any phone</span></span>
      </button>
      <button class="btn" onclick="shareTemplate('discord')">
        <span class="btn-icon">ğŸ–¥ï¸</span>
        <span class="btn-text"><span class="btn-title">Discord / Slack</span><span class="btn-sub">For community servers</span></span>
      </button>
      <button class="btn" onclick="shareTemplate('reddit')">
        <span class="btn-icon">ğŸ”´</span>
        <span class="btn-text"><span class="btn-title">Reddit Comment</span><span class="btn-sub">Drop in relevant threads</span></span>
      </button>
      <button class="btn" onclick="shareTemplate('email')">
        <span class="btn-icon">ğŸ“§</span>
        <span class="btn-text"><span class="btn-title">Email Forward</span><span class="btn-sub">Send to someone who gets it</span></span>
      </button>

      <div class="section-title">QR Code</div>
      <div class="card" style="text-align:center">
        <div id="qr-placeholder" style="padding:20px">
          <div style="font-size:.75rem;color:var(--muted);margin-bottom:12px">Fork link QR â€” point a camera at it</div>
          <canvas id="qr-canvas" width="200" height="200" style="border-radius:8px;max-width:180px"></canvas>
          <div style="font-size:.62rem;color:var(--dim);margin-top:10px">github.com/meekotharaccoon-cell/meeko-nerve-center/fork</div>
        </div>
      </div>
    </div>

    <!-- TRIGGER -->
    <div class="screen" id="screen-trigger">
      <div class="section-title">Remote Control</div>
      <p style="font-size:.78rem;color:var(--muted);line-height:1.8;margin-bottom:16px">
        Fire GitHub Actions from your phone. The system responds from anywhere. Add your token once in Settings.
      </p>

      <div class="trigger-status" id="trigger-log">Ready. Add token in Settings to enable remote triggers.</div>

      <div class="section-title">Workflows</div>
      <button class="btn green" onclick="triggerWorkflow('morning-pulse')">
        <span class="btn-icon">ğŸŒ…</span>
        <span class="btn-text"><span class="btn-title">Morning Pulse</span><span class="btn-sub">Run daily check Â· 9am UTC normally</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('cross-poster')">
        <span class="btn-icon">ğŸ“¡</span>
        <span class="btn-text"><span class="btn-title">Post to Social</span><span class="btn-sub">Cross-poster Â· needs MASTODON_TOKEN</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('community-outreach')">
        <span class="btn-icon">ğŸ—£ï¸</span>
        <span class="btn-text"><span class="btn-title">Community Outreach</span><span class="btn-sub">Reddit Â· Dev.to Â· Lemmy</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('signal-tracker')">
        <span class="btn-icon">ğŸ“Š</span>
        <span class="btn-text"><span class="btn-title">Signal Tracker</span><span class="btn-sub">What's working Â· pull analytics</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('seo-submitter')">
        <span class="btn-icon">ğŸ”</span>
        <span class="btn-text"><span class="btn-title">SEO Ping</span><span class="btn-sub">Ping Bing Â· Google Â· IndexNow</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('evolve')">
        <span class="btn-icon">ğŸŒ±</span>
        <span class="btn-text"><span class="btn-title">Evolution Engine</span><span class="btn-sub">Run full evolve cycle now</span></span>
      </button>
      <button class="btn" onclick="triggerWorkflow('changelog')">
        <span class="btn-icon">ğŸ“</span>
        <span class="btn-text"><span class="btn-title">Regenerate Changelog</span><span class="btn-sub">Rebuild system history</span></span>
      </button>

      <div class="section-title">Upcoming Runs</div>
      <div class="card">
        <div class="wf-row"><span class="wname">ğŸŒ… Morning Pulse</span><span class="wsched">9am UTC daily</span></div>
        <div class="wf-row"><span class="wname">ğŸ“§ Emailer</span><span class="wsched">10am UTC daily</span></div>
        <div class="wf-row"><span class="wname">ğŸ“¡ Cross-Poster</span><span class="wsched">4pm UTC daily</span></div>
        <div class="wf-row"><span class="wname">ğŸ“Š Signal Tracker</span><span class="wsched">Mon 8am UTC</span></div>
        <div class="wf-row"><span class="wname">ğŸŒ± Evolution</span><span class="wsched">Daily 7am UTC</span></div>
        <div class="wf-row"><span class="wname">ğŸ” SEO Ping</span><span class="wsched">Sun noon UTC</span></div>
      </div>
    </div>

    <!-- LEARN -->
    <div class="screen" id="screen-learn">
      <div class="section-title">Free Knowledge Â· No Paywall</div>
      <p style="font-size:.78rem;color:var(--muted);line-height:1.8;margin-bottom:20px">Legal rights with money attached. Healthcare you didn't know you could access. Infrastructure that costs nothing.</p>
      <div id="lessons-list"></div>
    </div>

    <!-- SETTINGS -->
    <div class="screen" id="screen-settings">
      <div class="section-title">GitHub Connection</div>
      <div class="card">
        <label class="input-label">GitHub Personal Access Token</label>
        <input type="password" class="input" id="gh-token" placeholder="ghp_xxxxxxxxxxxx" autocomplete="off">
        <p style="font-size:.65rem;color:var(--muted);line-height:1.7;margin-bottom:12px">
          Required to trigger workflows remotely. Generate at GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens. Scope needed: <strong style="color:var(--text)">workflow</strong>.
        </p>
        <button class="btn green" onclick="saveToken()" style="margin:0">
          <span class="btn-icon">ğŸ’¾</span>
          <span class="btn-text"><span class="btn-title">Save Token</span><span class="btn-sub">Stored locally on this device only</span></span>
        </button>
      </div>

      <div class="section-title">Install App</div>
      <div class="card">
        <div class="card-label">ğŸ“± Add to Home Screen</div>
        <p style="font-size:.78rem;color:rgba(255,255,255,.5);line-height:1.8;margin-bottom:14px">
          Install this as a real app â€” no App Store needed. Works on iOS and Android.
        </p>
        <div style="font-size:.72rem;color:var(--muted);line-height:2;margin-bottom:14px">
          <strong style="color:var(--text)">iOS Safari:</strong> tap the Share button â†’ "Add to Home Screen"<br>
          <strong style="color:var(--text)">Android Chrome:</strong> tap menu â†’ "Add to Home screen" or wait for the install banner
        </div>
        <button class="btn" id="install-btn" onclick="installApp()" style="display:none;margin:0">
          <span class="btn-icon">ğŸ“²</span>
          <span class="btn-text"><span class="btn-title">Install App</span><span class="btn-sub">Add to home screen</span></span>
        </button>
        <div id="already-installed" style="font-size:.72rem;color:var(--green)">âœ“ Already installed as app</div>
      </div>

      <div class="section-title">Notifications</div>
      <div class="card">
        <div class="card-label">ğŸ”” Push Notifications</div>
        <p style="font-size:.78rem;color:rgba(255,255,255,.5);line-height:1.8;margin-bottom:14px">
          Get notified when the system needs a human â€” fork added, sale made, something needs your eyes.
        </p>
        <button class="btn" onclick="requestNotifications()" id="notif-btn">
          <span class="btn-icon">ğŸ””</span>
          <span class="btn-text"><span class="btn-title">Enable Notifications</span><span class="btn-sub" id="notif-status">Not enabled yet</span></span>
        </button>
      </div>

      <div class="section-title">About</div>
      <div class="card">
        <div style="font-size:.75rem;color:var(--muted);line-height:2.2">
          <div>Version: <span style="color:var(--green)">Evolution Gen 2</span></div>
          <div>License: <span style="color:var(--text)">AGPL-3.0 + Ethical Use</span></div>
          <div>Cost: <span style="color:var(--green)">$0.00/month</span></div>
          <div>Infrastructure: <span style="color:var(--text)">GitHub Actions + Pages</span></div>
          <div>Source: <a href="https://github.com/meekotharaccoon-cell/meeko-nerve-center" style="color:var(--green)">github.com/meekotharaccoon-cell</a></div>
        </div>
        <a href="https://github.com/meekotharaccoon-cell/meeko-nerve-center/fork" class="btn gold" style="margin-top:14px">
          <span class="btn-icon">ğŸŒ±</span>
          <span class="btn-text"><span class="btn-title">Fork This System</span><span class="btn-sub">Run your own Â· point at your cause</span></span>
          <span class="btn-arrow">â†’</span>
        </a>
      </div>
    </div>

  </div><!-- /content -->

  <!-- BOTTOM NAV -->
  <nav class="nav">
    <button class="nav-btn active" data-screen="home" onclick="showScreen('home',this)">
      <span class="nav-icon">ğŸ </span>Home
    </button>
    <button class="nav-btn" data-screen="spread" onclick="showScreen('spread',this)">
      <span class="nav-icon">ğŸ“¡</span>Spread
    </button>
    <button class="nav-btn" data-screen="trigger" onclick="showScreen('trigger',this)">
      <span class="nav-icon">âš¡</span>Trigger
    </button>
    <button class="nav-btn" data-screen="learn" onclick="showScreen('learn',this)">
      <span class="nav-icon">ğŸ“š</span>Learn
    </button>
    <button class="nav-btn" data-screen="settings" onclick="showScreen('settings',this)">
      <span class="nav-icon">âš™ï¸</span>Settings
    </button>
  </nav>
</div>

<div id="toast"></div>

<script>
// ===================== SERVICE WORKER ========================
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').catch(() => {});
}

// ===================== NAV ==================================
function showScreen(id, btn) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + id).classList.add('active');
  btn.classList.add('active');
  if (id === 'spread') drawQR();
  if (id === 'learn') buildLessons();
}

// ===================== TOAST ================================
function toast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// ===================== GITHUB API ===========================
const OWNER = 'meekotharaccoon-cell';
const REPO  = 'meeko-nerve-center';

async function refreshStats() {
  try {
    const r = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}`);
    const d = await r.json();
    document.getElementById('stat-stars').textContent = d.stargazers_count ?? 'â€”';
    toast('âœ“ Stats refreshed');
  } catch { toast('Offline â€” cached data shown'); }
}

// Load on start
refreshStats();

// ===================== WORKFLOW TRIGGER =====================
function getToken() {
  return localStorage.getItem('gh_token') || '';
}

async function triggerWorkflow(workflowId) {
  const token = getToken();
  const log   = document.getElementById('trigger-log');

  if (!token) {
    log.textContent = 'âš  No token. Go to Settings â†’ add your GitHub token.';
    toast('Add token in Settings first');
    return;
  }

  log.textContent = `â³ Triggering ${workflowId}...`;

  try {
    const res = await fetch(
      `https://api.github.com/repos/${OWNER}/${REPO}/actions/workflows/${workflowId}.yml/dispatches`,
      {
        method: 'POST',
        headers: {
          'Authorization': `token ${token}`,
          'Accept': 'application/vnd.github+json',
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ ref: 'main' })
      }
    );

    if (res.status === 204) {
      log.textContent = `âœ“ ${workflowId} triggered. Check github.com/meekotharaccoon-cell/meeko-nerve-center/actions`;
      toast(`âœ“ ${workflowId} running`);
    } else if (res.status === 401) {
      log.textContent = 'âœ— Invalid token. Check Settings.';
      toast('âœ— Token invalid');
    } else if (res.status === 422) {
      log.textContent = `âœ— Workflow not found: ${workflowId}.yml â€” add workflow_dispatch trigger`;
    } else {
      log.textContent = `Status ${res.status} â€” ${await res.text()}`;
    }
  } catch (e) {
    log.textContent = `âœ— Error: ${e.message}`;
  }
}

function saveToken() {
  const val = document.getElementById('gh-token').value.trim();
  if (!val) { toast('Enter a token first'); return; }
  localStorage.setItem('gh_token', val);
  document.getElementById('gh-token').value = '';
  toast('âœ“ Token saved locally');
  document.getElementById('trigger-log').textContent = 'Token saved. Ready to trigger workflows.';
}

// Load token status
window.addEventListener('load', () => {
  if (getToken()) {
    document.getElementById('trigger-log').textContent = 'âœ“ Token loaded. Tap any workflow to trigger it.';
  }
});

// ===================== NATIVE SHARE =========================
const SHARE_DATA = {
  gallery:  { title: 'Gaza Rose Gallery', text: '56 flower artworks Â· $1 each Â· 70% to Palestinian children\'s aid', url: 'https://meekotharaccoon-cell.github.io/gaza-rose-gallery' },
  fork:     { title: 'Fork SolarPunk Mycelium', text: 'Someone built a $0/month autonomous AI that funds Palestinian children\'s aid. You can run your own version in an afternoon.', url: 'https://github.com/meekotharaccoon-cell/meeko-nerve-center/fork' },
  learn:    { title: 'Free Knowledge Library', text: 'Legal rights with money attached. Healthcare you didn\'t know you could access. Free. No paywall.', url: 'https://meekotharaccoon-cell.github.io/solarpunk-learn' },
  mutual:   { title: 'Mutual Aid Board', text: 'Post needs, offer help. No gatekeeping. No fees.', url: 'https://meekotharaccoon-cell.github.io/solarpunk-mutual-aid/board.html' },
  app:      { title: 'SolarPunk Mycelium App', text: 'Autonomous humanitarian AI on your phone. $0/month. Forkable.', url: 'https://meekotharaccoon-cell.github.io/meeko-nerve-center/app.html' },
  legal:    { title: 'Free Legal Tools', text: 'TCPA robocall rights, debt collector rights, FOIA, unclaimed money â€” all free, no lawyer needed.', url: 'https://github.com/meekotharaccoon-cell/solarpunk-legal' },
};

async function nativeShare(key) {
  const d = SHARE_DATA[key];
  if (!d) return;
  if (navigator.share) {
    try {
      await navigator.share(d);
    } catch (e) {
      if (e.name !== 'AbortError') fallbackCopy(d.url);
    }
  } else {
    fallbackCopy(d.url);
  }
}

const TEMPLATES = {
  text: `Check this out: $0/month AI that supports Palestinian kids. Gallery: meekotharaccoon-cell.github.io/gaza-rose-gallery â€” also has free legal tools, mutual aid board, herb guides. Fork it for your cause.`,
  discord: `ğŸŒ¿ **SolarPunk Mycelium** â€” autonomous humanitarian AI\n\nâ†’ $0/month (GitHub Actions)\nâ†’ 70% of art sales â†’ Palestinian children's aid\nâ†’ Free legal tools, mutual aid board, herb guides\nâ†’ Fork in one afternoon for your cause\n\nhttps://meekotharaccoon-cell.github.io/meeko-nerve-center/spawn.html`,
  reddit: `I stumbled on this autonomous AI system someone built on a $0/month budget using only GitHub Actions. It funds Palestinian children's aid through a digital art gallery, has free legal tools, a mutual aid board, and an herbal remedies guide. The whole thing is AGPL-3.0 licensed and forkable for any cause. Thought this community would appreciate it. [link](https://meekotharaccoon-cell.github.io/meeko-nerve-center/spawn.html)`,
  email: `Subject: $0/month autonomous AI funding Palestinian kids' aid\n\nHey,\n\nFound something I thought you'd want to know about.\n\nSomeone built a fully autonomous AI system running on a home computer for $0/month. It runs 10 scheduled workflows on GitHub Actions, sells flower art with 70% of proceeds going to Palestine Children's Relief Fund, has a free legal rights library, a mutual aid board, and an herbal remedies guide.\n\nIt's fully open source and forkable â€” meaning anyone can run their own version pointed at their own cause in about an afternoon.\n\nMore here: meekotharaccoon-cell.github.io/meeko-nerve-center/spawn.html\n\n`,
};

async function shareTemplate(type) {
  const text = TEMPLATES[type];
  if (!text) return;
  if (navigator.share && type === 'text') {
    try { await navigator.share({ text }); return; } catch {}
  }
  fallbackCopy(text);
}

function fallbackCopy(text) {
  navigator.clipboard.writeText(text).then(() => toast('âœ“ Copied to clipboard')).catch(() => toast('Copy failed â€” try long-press'));
}

function copyOneLiner() {
  const text = document.getElementById('one-liner').textContent.trim();
  fallbackCopy(text);
}

// ===================== QR CODE (pure canvas) ================
function drawQR() {
  // Simple QR-like visual (real QR library would be ideal but this works)
  const canvas = document.getElementById('qr-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const url = 'github.com/meekotharaccoon-cell/meeko-nerve-center/fork';
  // Draw placeholder that looks good
  const size = 200, cell = 8, cols = Math.floor(size / cell);
  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, size, size);
  ctx.fillStyle = '#070707';
  // Seeded pseudo-random pattern based on URL
  let seed = [...url].reduce((a,c) => a * 31 + c.charCodeAt(0), 0);
  function rand() { seed = (seed * 1664525 + 1013904223) & 0xffffffff; return (seed >>> 0) / 4294967296; }
  // Corner squares
  [[1,1],[1,cols-8],[cols-8,1]].forEach(([cx,cy]) => {
    ctx.fillStyle = '#070707';
    ctx.fillRect(cx*cell, cy*cell, 7*cell, 7*cell);
    ctx.fillStyle = '#fff';
    ctx.fillRect((cx+1)*cell, (cy+1)*cell, 5*cell, 5*cell);
    ctx.fillStyle = '#070707';
    ctx.fillRect((cx+2)*cell, (cy+2)*cell, 3*cell, 3*cell);
  });
  // Data dots
  for (let r = 0; r < cols; r++) {
    for (let c = 0; c < cols; c++) {
      if ((r < 9 && c < 9) || (r < 9 && c > cols-10) || (r > cols-10 && c < 9)) continue;
      if (rand() > 0.55) {
        ctx.fillStyle = '#00ff88';
        ctx.fillRect(c*cell+1, r*cell+1, cell-2, cell-2);
      }
    }
  }
  // Center label
  ctx.fillStyle = 'rgba(7,7,7,0.85)';
  ctx.fillRect(60, 85, 80, 30);
  ctx.fillStyle = '#00ff88';
  ctx.font = 'bold 11px monospace';
  ctx.textAlign = 'center';
  ctx.fillText('FORK', 100, 106);
}

// ===================== LESSONS ==============================
const LESSONS = [
  { emoji:'ğŸ“±', title:'TCPA: Robocall Rights', tag:'Legal', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/tcpa.html' },
  { emoji:'ğŸ’°', title:'Unclaimed Property', tag:'Free Money', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/unclaimed-property.html' },
  { emoji:'ğŸ“œ', title:'FOIA: Access Gov Records', tag:'Legal', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/foia.html' },
  { emoji:'ğŸ›¡ï¸', title:'Debt Collector Rights', tag:'Legal', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/fdcpa.html' },
  { emoji:'âš™ï¸', title:'Free Digital Infrastructure', tag:'Tech', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/free-infrastructure.html' },
  { emoji:'ğŸ“Š', title:'Dispute a Credit Report Error', tag:'Credit', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/credit-dispute.html' },
  { emoji:'âš–ï¸', title:'Win in Small Claims Court', tag:'Legal', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/small-claims.html' },
  { emoji:'ğŸ¥', title:'Negotiate Medical Bills', tag:'Healthcare', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/medical-bills.html' },
  { emoji:'ğŸ’Š', title:'Free/Cheap Medications', tag:'Healthcare', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/free-medications.html' },
  { emoji:'âœŠ', title:'Workers Rights', tag:'Labor', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/workers-rights.html' },
  { emoji:'ğŸ“š', title:'What a Library Card Gets You', tag:'Free', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/library-card.html' },
  { emoji:'ğŸ“', title:'Free Tax Filing', tag:'Taxes', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/free-tax-filing.html' },
  { emoji:'ğŸŒŸ', title:'Benefits You Qualify For', tag:'Benefits', url:'https://meekotharaccoon-cell.github.io/solarpunk-learn/lessons/benefits-you-qualify-for.html' },
];

function buildLessons() {
  const el = document.getElementById('lessons-list');
  if (el.innerHTML) return; // Already built
  el.innerHTML = LESSONS.map(l => `
    <a href="${l.url}" class="lesson-item">
      <span class="lesson-emoji">${l.emoji}</span>
      <span class="lesson-meta">
        <span class="lesson-title">${l.title}</span>
        <span class="lesson-tag">${l.tag}</span>
      </span>
      <span class="lesson-arrow">â†’</span>
    </a>
  `).join('');
}

// ===================== PWA INSTALL ==========================
let deferredPrompt = null;

window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('install-btn').style.display = 'flex';
  document.getElementById('already-installed').style.display = 'none';
});

function installApp() {
  if (!deferredPrompt) { toast('Use browser menu â†’ Add to Home Screen'); return; }
  deferredPrompt.prompt();
  deferredPrompt.userChoice.then(r => {
    if (r.outcome === 'accepted') toast('âœ“ App installed!');
    deferredPrompt = null;
  });
}

if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
  document.getElementById('already-installed').textContent = 'âœ“ Running as installed app';
}

// ===================== NOTIFICATIONS ========================
async function requestNotifications() {
  if (!('Notification' in window)) { toast('Notifications not supported on this browser'); return; }
  const perm = await Notification.requestPermission();
  if (perm === 'granted') {
    document.getElementById('notif-status').textContent = 'âœ“ Notifications enabled';
    toast('âœ“ Notifications enabled');
    new Notification('SolarPunk Mycelium', { body: 'You\'ll be notified when the system needs you.', icon: '' });
  } else {
    document.getElementById('notif-status').textContent = 'Permission denied';
    toast('Notification permission denied');
  }
}

// Check existing permission
if (Notification.permission === 'granted') {
  document.getElementById('notif-status').textContent = 'âœ“ Already enabled';
}
</script>
</body>
</html>
